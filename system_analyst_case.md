<!-- Заголовки -->

# Кейс для системного аналитика
### Потенциальные подводные камни

* Защита данных. Передача личной информации клиентов требует особого внимания к защите данных и соблюдению законодательства о персональных данных и политики конфиденциальности.
* Обработка большого объема данных. Если акция пользуется большой популярностью, то количество передаваемых данных может быть огромным, что потребует достаточно мощной инфраструктуры для обработки этих данных в режиме реального времени.
* Согласование формата передаваемых данных. Возможны проблемы с соответствием форматов данных, так как данные могут храниться в разных форматах в системах ретейлера и Тинькофф.
* Надежность и масштабируемость. Решение должно быть масштабируемым и надежным, чтобы обеспечивать непрерывность работы системы и обработку большого объема данных. Необходимо убедиться в том, что система способна обрабатывать информацию в режиме реального времени и поддерживать большое количество одновременных запросов.
* Обработка ошибок и сбоев. В ходе интеграции могут возникать ошибки, сбои и проблемы с синхронизацией данных. Необходимо предусмотреть механизмы для обработки ошибок и сбоев, чтобы избежать негативных последствий для клиентов и бизнеса.
* Техническая поддержка. Необходимо предусмотреть механизм технической поддержки для клиентов, в случае если они столкнутся с проблемами при участии в акции. Кроме того, необходимо обеспечить техническую поддержку для ретейлера, чтобы избежать задержек и проблем в процессе передачи данных.

<!-- Код -->

Спецификация endpoint'а [`OpenAPI/Swagger`]:

```yaml
openapi: 3.0.0
info:
  version: 1.0.0
  title: Регистрация клиента акции
  description: Endpoint для регистрации клиента акции
servers:
  - url: https://api.tinkoff.ru
paths:
  /api/register-client:
    post:
      summary: Регистрация клиента акции
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                fio:
                  type: string
                  description: ФИО клиента. Обязательный параметр.
                  example: Иванов Иван Иванович
                phone:
                  type: string
                  description: Номер телефона клиента. Обязательный параметр. Должен быть в формате E.164.
                  example: +79111234567
                email:
                  type: string
                  description: Email клиента. Обязательный параметр. Должен быть валидным email-адресом.
                  example: ivanov@mail.ru
                purchases:
                  type: array
                  description: Массив с информацией о покупках в рамках акции. Обязательный параметр.
                  items:
                    type: object
                    properties:
                      name:
                        type: string
                        description: Название товара. Обязательный параметр.
                        example: Телевизор Samsung
                      price:
                        type: number
                        format: float
                        description: Цена товара. Обязательный параметр. Должен быть положительным числом.
                        example: 40000.00
              required:
                - fio
                - phone
                - email
                - purchases
              minItems: 1
              maxItems: 10
      responses:
        '200':
          description: OK. Возвращает ID зарегистрированного клиента.
          content:
            application/json:
              schema:
                type: object
                properties:
                  client_id:
                    type: integer
                    example: 12345
        '400':
          description: Bad Request. Неверный формат запроса или отсутствуют обязательные параметры. Возвращает информацию об ошибке в теле ответа.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Не указан номер телефона"
        '401':
          description: Unauthorized. Ошибка аутентификации.
        '500':
          description: Internal Server Error. Ошибка на сервере.

```
### Структура хранения информации в базе данных

* Можно использовать реляционную базу данных, например, PostgreSQL. Можно создать две таблицы: Clients и Purchases, и связать их по идентификатору клиента. Структуры таблиц могут быть следующими:

Clients:
```sql
id (int, primary key)
fio (varchar(50))
phone (varchar(16))
email (varchar(50))
```
Purchases:
```sql
id (int, primary key)
client_id (int, foreign key to Clients.id)
name (varchar(50))
price (numeric(10,2))
```

